<!DOCTYPE html>
<html>
  <head>
    <title>Select now</title>
    <style>
      @import url('https://fonts.googleapis.com/css2?family=Roboto:ital,wght@0,100..900;1,100..900&display=swap');

      h1, h2 {
        text-align: center;
        font-family: Roboto, sans-serif;
      }

      html, body {
        height: 100%;
        background-color: #1f1f1f;
        color: #f1f1f1;
      }

      .option_container {
        display: flex;
        width: 100%;
        height: 70%;
        justify-content: center;
        row-gap: 2rem;
        align-items: center;
      }

      button, .option {
        width: 100%;
        height: 100%;
        font-size: 24pt;
        background-color: black;
        color: white;
      }

      .option_text {
        text-align: center;
        width: 70%;
        font-size: 200pt;
      }
    </style>
  </head>
  <body>
    <h2 id="status">Matchup: ...</h2>
    <h1>What is funnier?</h1>

    <div class="option_container">
      <div class="option" id="option_1">Loading...</div>
      <div class="option_text" class="or">or</div>
      <div class="option" id="option_2">Loading...</div>
    </div>

    <script src="/socket.io/socket.io.js"></script>
    <script>
      const socket = io();

      socket.emit('ident', window.location.pathname.replace(/^\/|\/$/g, ''));

      socket.on('voting_status', (msg) => {
        if (msg == "Voting Complete") {
          let elements = document.getElementsByTagName("div");
          for (let i = 0; i < elements.length; i++) {
            elements.item(i).remove();
          }
          elements = document.getElementsByTagName("h1");
          for (let i = 0; i < elements.length; i++) {
            elements.item(i).remove();
          }
          document.getElementById("status").innerHTML = "Matchup: " + msg;
        } else {
          document.getElementById("status").innerHTML = "Matchup: " + msg;
        }
      });

      socket.on('options', (msg) => {
        document.getElementById("option_1").innerHTML = "<button onClick=\"send_choice(`" + msg[0] + "`)\">" + msg[0] + "</button>";
        document.getElementById("option_2").innerHTML = "<button onClick=\"send_choice(`" + msg[1] + "`)\">" + msg[1] + "</button>";
      });

      function send_choice(msg) {
        socket.emit('result', msg);
        socket.emit('ident', window.location.pathname.replace(/^\/|\/$/g, ''));
      }
    </script>
  </body>
</html>
